apiVersion: v1
kind: ConfigMap
metadata:
  name: nextcloud-redis-configuration
  namespace: local-cloud
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/instance: nextcloud
data:
  redis.conf: |
    # User-supplied Redis configuration:
    # Enable AOF https://redis.io/topics/persistence#append-only-file
    appendonly yes
    # Set AOF directory to /data (which is writable)
    dir /data
    # Disable RDB persistence, AOF persistence already enabled.
    save ""
    # Disable protected mode since we're using password auth
    protected-mode no
  replica.conf: |
    # Replica configuration
    appendonly yes
    dir /data
    save ""
    protected-mode no
