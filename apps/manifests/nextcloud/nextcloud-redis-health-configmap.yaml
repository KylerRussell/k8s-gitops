apiVersion: v1
kind: ConfigMap
metadata:
  name: nextcloud-redis-health
  namespace: local-cloud
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/instance: nextcloud
data:
  ping_liveness_local.sh: |
    #!/bin/bash
    # Read password from secret
    REDIS_PASSWORD=$(cat /opt/bitnami/redis/secrets/redis-password)
    response=$(redis-cli -h localhost -p 6379 -a "$REDIS_PASSWORD" ping)
    if [ "$response" != "PONG" ]; then
      exit 1
    fi
  ping_readiness_local.sh: |
    #!/bin/bash
    # Read password from secret
    REDIS_PASSWORD=$(cat /opt/bitnami/redis/secrets/redis-password)
    response=$(redis-cli -h localhost -p 6379 -a "$REDIS_PASSWORD" ping)
    if [ "$response" != "PONG" ]; then
      exit 1
    fi
